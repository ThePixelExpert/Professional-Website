# =============================================================================
# Supabase Production Environment Configuration
# =============================================================================
# CRITICAL: Generate ALL secrets BEFORE first start!
# DO NOT use default values - this creates security vulnerabilities.
# Use generate-secrets.sh to generate all secrets automatically.
# =============================================================================

############
# SECRETS - MUST GENERATE BEFORE FIRST START
############
# These values CANNOT be changed after first start without data loss.
# Use ./generate-secrets.sh to generate all values.

# PostgreSQL password (alphanumeric only, 32 chars)
# Generate: openssl rand -base64 32 | tr -d '/+=' | head -c 32
POSTGRES_PASSWORD=

# JWT secret for signing authentication tokens (base64, 48+ chars)
# Generate: openssl rand -base64 48
# NOTE: ANON_KEY and SERVICE_ROLE_KEY must be signed with this secret
JWT_SECRET=

# Supabase anon (public) key - JWT token with 'anon' role
# Generate: Use Supabase JWT generator or supabase CLI after setting JWT_SECRET
# https://supabase.com/docs/guides/self-hosting/docker#generate-api-keys
ANON_KEY=

# Supabase service role (admin) key - JWT token with 'service_role' role
# Generate: Use Supabase JWT generator or supabase CLI after setting JWT_SECRET
# https://supabase.com/docs/guides/self-hosting/docker#generate-api-keys
SERVICE_ROLE_KEY=

# Secret key base for Phoenix services (base64, 48+ chars)
# Generate: openssl rand -base64 48
SECRET_KEY_BASE=

# Vault encryption key for encrypted fields (hex, exactly 32 chars)
# Generate: openssl rand -hex 16
VAULT_ENC_KEY=

# Logflare public access token (base64, 32 chars)
# Generate: openssl rand -base64 32 | tr -d '/+=' | head -c 32
LOGFLARE_PUBLIC_ACCESS_TOKEN=

# Logflare private access token (base64, 32 chars)
# Generate: openssl rand -base64 32 | tr -d '/+=' | head -c 32
LOGFLARE_PRIVATE_ACCESS_TOKEN=

############
# API URLs
############
# Set these to your production domain BEFORE first start.
# These URLs are embedded in email links and OAuth callbacks.

# Public Supabase API URL (accessed by frontend)
SUPABASE_PUBLIC_URL=https://supabase.edwardstech.dev

# External API URL (used for email links and callbacks)
API_EXTERNAL_URL=https://supabase.edwardstech.dev

# Frontend site URL (for OAuth redirects)
SITE_URL=https://www.edwardstech.dev

############
# DATABASE
############
# Internal Docker networking - DO NOT change these

POSTGRES_HOST=db
POSTGRES_DB=postgres
POSTGRES_PORT=5432

############
# AUTH - JWT SETTINGS
############

JWT_EXPIRY=3600

############
# AUTH - GOOGLE OAUTH
############
# Get credentials from https://console.cloud.google.com/
# Create OAuth 2.0 Client ID and add authorized redirect URI

GOTRUE_EXTERNAL_GOOGLE_ENABLED=true
GOTRUE_EXTERNAL_GOOGLE_CLIENT_ID=
GOTRUE_EXTERNAL_GOOGLE_SECRET=
GOTRUE_EXTERNAL_GOOGLE_REDIRECT_URI=https://supabase.edwardstech.dev/auth/v1/callback

############
# SMTP (OPTIONAL - can be configured later)
############
# Required for email-based authentication (magic links, password resets)
# Comment out if not using email auth initially

# GOTRUE_SMTP_HOST=smtp.sendgrid.net
# GOTRUE_SMTP_PORT=587
# GOTRUE_SMTP_USER=apikey
# GOTRUE_SMTP_PASS=
# GOTRUE_SMTP_ADMIN_EMAIL=admin@edwardstech.dev
# GOTRUE_SMTP_SENDER_NAME=Edwards Engineering

############
# STORAGE
############

# Use file storage (default)
STORAGE_BACKEND=file

# For S3-compatible storage (optional, configure later):
# STORAGE_BACKEND=s3
# STORAGE_S3_BUCKET=supabase-storage
# STORAGE_S3_REGION=us-east-1
# STORAGE_S3_ENDPOINT=
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=

# =============================================================================
# DEPLOYMENT CHECKLIST
# =============================================================================
# Before first start:
# [ ] Run ./generate-secrets.sh and copy output to this file
# [ ] Generate ANON_KEY and SERVICE_ROLE_KEY using JWT_SECRET
# [ ] Set API_EXTERNAL_URL to your domain
# [ ] Set SUPABASE_PUBLIC_URL to your domain
# [ ] Set SITE_URL to your frontend domain
# [ ] Configure Google OAuth credentials
# [ ] Review all SMTP settings if using email auth
# [ ] Save this file as .env (not .env.template)
# [ ] NEVER commit .env to git!
#
# After first start:
# [ ] Verify all services healthy: docker compose ps
# [ ] Access Supabase Studio at https://supabase.edwardstech.dev
# [ ] Configure Auth Hooks in Studio (custom_access_token_hook)
# [ ] Apply database migrations
# [ ] Test OAuth login flow
# =============================================================================
